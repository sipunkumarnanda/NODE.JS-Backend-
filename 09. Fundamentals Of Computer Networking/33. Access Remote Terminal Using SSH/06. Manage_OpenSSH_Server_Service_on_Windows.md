

# üîÅ Turn On & Open **OpenSSH Server** (Windows Services) ‚Äî In-depth guide üîê

Below is a thorough, practical walkthrough of how to *start, enable and manage* the OpenSSH server on Windows using the Services GUI (right-click ‚Üí Properties ‚Üí Startup type ‚Üí Automatic) ‚Äî plus PowerShell/`sc` equivalents, what every option means, useful checks, and troubleshooting. Emojis for readability. Let‚Äôs go!

---

## ü™ü Open the Services console (where to start)

1. Press **Win + R**, type `services.msc`, and press **Enter**.
   *Or:* Start ‚Üí type **Services** ‚Üí open **Services (Desktop app)**.
2. In the list, locate **OpenSSH SSH Server** (Display name) ‚Äî its service name is usually **`sshd`**.
3. Right-click the service to see the context menu: **Start**, **Stop**, **Restart**, **Pause**, **Properties**, **Open Event Viewer**, etc.

---

## ‚ñ∂Ô∏è Start / Stop / Restart / Pause ‚Äî what each button does

* **Start** ‚Äî launches the service process now (creates the `sshd.exe` process).
* **Stop** ‚Äî terminates the service process. Active SSH sessions will be disconnected.
* **Restart** ‚Äî Stop followed by Start; useful after config changes.
* **Pause / Resume** ‚Äî rarely used for SSH; pauses service processing and resumes later.

When to use:

* Use **Start** after install or after manual stop.
* Use **Restart** after editing `/etc/ssh/sshd_config` or changing host keys.
* Use **Stop** if you must immediately block SSH connections.

---

## ‚öôÔ∏è Properties window ‚Äî tabs & every setting explained (IN DEPTH)

Double-click the service (or Right-click ‚Üí **Properties**) to open the Properties dialog. Important tabs: **General**, **Log On**, **Recovery**, **Dependencies**, and sometimes **Triggers**.

### 1. General tab

* **Service name** ‚Äî internal name (e.g. `sshd`) used in commands.
* **Display name** ‚Äî shown in the Services list (OpenSSH SSH Server).
* **Description** ‚Äî short text about the service.
* **Path to executable** ‚Äî full path to `sshd.exe` and any flags (e.g. `C:\Windows\System32\OpenSSH\sshd.exe`). If the path is wrong or file missing, service won't start.
* **Startup type** ‚Äî controls whether/how the service starts at boot (see next section).
* **Service status** ‚Äî shows `Running`, `Stopped`, etc., and has the Start/Stop/Restart buttons.
* **Start parameters** ‚Äî a disposable field where you can type parameters to start the service right now; *these parameters are not persisted* ‚Äî they only apply to that single manual Start action.

### 2. Startup type (what the options mean)

* **Automatic** ‚Äî service starts during system boot. Good for servers you want always available.
* **Automatic (Delayed Start)** ‚Äî service starts shortly after boot, giving priority to critical system services; useful if the service depends on networking components that may come up late. Use this if SSH sometimes starts before network is ready.
* **Manual** ‚Äî service does not start on boot; you must start it manually (or another program starts it).
* **Disabled** ‚Äî service cannot be started (prevents accidental starts). Use for security when you do not want SSH running at all.

**Recommendation for SSH:** choose **Automatic** (if machine is a remote server). If your network is flaky at boot and SSH depends on network drivers, **Automatic (Delayed Start)** can help.

### 3. Log On tab

* **Local System account** ‚Äî a powerful built-in account with broad privileges. Some services use it by default.
* **This account** ‚Äî specify a domain/user account under which the service runs (useful if the service needs access to network resources using a specific identity).
* **Local Service / Network Service / virtual service accounts (e.g. `NT SERVICE\sshd`)** ‚Äî more restricted accounts used by many modern services for better isolation.

**Why it matters:** the account determines what files, folders, registry keys and network resources the service can access. Changing the account requires giving that account required permissions (and possibly entering a password). For OpenSSH on Windows the service commonly runs under a virtual service account ‚Äî changing it may break key access or authentication.

### 4. Recovery tab

Controls what Windows does if the service fails/crashes:

* **First failure / Second failure / Subsequent failures** ‚Äî actions you can pick: *Take No Action*, *Restart the Service*, *Run a Program*, *Restart the Computer*.
* **Reset fail count after** ‚Äî how long before failure counters reset.
* **Restart service after** ‚Äî delay before trying to restart.

**Best practice for SSH:** set **First failure ‚Üí Restart the Service**, with a short restart delay (e.g. 1 minute). This reduces downtime if `sshd` crashes.

### 5. Dependencies tab

Shows:

* **Services that this service depends on** (Windows will try to start those first).
* **Services that depend on this service** (will be stopped if you stop this service).

If a dependency is missing/stopped, `sshd` may not start ‚Äî this tab helps diagnose that.

### 6. Triggers tab (when present)

Some services have *triggers* (start/stop on events, e.g. network availability). For `sshd`, you might see triggers related to network availability or user logon on some builds. Triggers allow services to start only when relevant.

---

## üñ•Ô∏è GUI ‚Üí PowerShell / CLI equivalents (commands you can run)

**PowerShell**

```powershell
# Start now
Start-Service -Name sshd

# Stop
Stop-Service -Name sshd

# Restart
Restart-Service -Name sshd

# Enable at boot (set to Automatic)
Set-Service -Name sshd -StartupType Automatic

# Check status
Get-Service -Name sshd
```

**`sc.exe` (classic)**

```cmd
# Query status
sc query sshd

# Set startup to automatic
sc config sshd start= auto

# Set delayed automatic start
sc config sshd start= delayed-auto
```

*(Note: `sc` requires the `start=` token followed by a space.)*

---

## üîé Verify the service & that SSH is listening (checks)

* Check service status:

  ```powershell
  Get-Service sshd
  ```
* Verify port 22 is listening:

  ```powershell
  netstat -ano | findstr :22
  # or PowerShell:
  Get-NetTCPConnection -LocalPort 22
  ```
* Check which process owns the port:

  ```powershell
  netstat -aon | findstr :22
  tasklist /fi "PID eq <pid>"
  ```

---

## üßæ Check logs (if service fails or behaves oddly)

* Open **Event Viewer** (Win + R ‚Üí `eventvwr.msc`).
* Navigate to **Applications and Services Logs ‚Üí OpenSSH** (there may be Admin/Operational channels) or check **Windows Logs ‚Üí System/Application** for service error events.
* Use logs to see authentication errors, permission problems, or why `sshd` failed to start.

---

## üîê Common issues & what to look for

* **Service won‚Äôt start**

  * Check *Path to executable* exists.
  * Check Event Viewer for errors (missing DLL, permission denied).
  * Confirm required dependencies are running (e.g., network).
* **Port 22 already in use**

  * `netstat -ano | findstr :22` to find process using the port; stop that process or change SSH port in `C:\ProgramData\ssh\sshd_config`.
* **Key or auth failures**

  * OpenSSH on Windows is sensitive to ACLs on `%USERPROFILE%\.ssh\authorized_keys` and files under `C:\ProgramData\ssh`. Check and tighten permissions.
* **Changing Log On account breaks access**

  * If you change the account under **Log On**, ensure it has access to the SSH files and permission to run the executable.

---

## üîÅ Recommended service startup & recovery configuration for servers

1. **Startup type:** `Automatic` (or `Automatic (Delayed Start)` if network may not be ready at boot).
2. **Recovery:** First Failure = `Restart the Service`, Second Failure = `Restart the Service`, Subsequent = `Take No Action` or `Restart`. Reset fail count after 1 day (86400 seconds) and restart service after 1 minute.
3. **Log On:** use the default recommended account for OpenSSH (do not swap to an arbitrary user unless required).
4. **Firewall:** ensure Windows Firewall has an inbound rule (OpenSSH-Server-In-TCP) allowing port 22.

---

## üß∞ Quick checklist (GUI + CLI) ‚Äî copy/paste friendly

**GUI**

1. `Win + R` ‚Üí `services.msc` ‚Üí find **OpenSSH SSH Server**.
2. Right-click ‚Üí **Start** (or **Restart**) to run it now.
3. Right-click ‚Üí **Properties** ‚Üí **Startup type** ‚Üí choose **Automatic** ‚Üí **OK**.
4. (Optional) Properties ‚Üí **Recovery** ‚Üí set **Restart the Service** on first/second failure.

**PowerShell**

```powershell
# Install was done previously; now enable & start
Set-Service -Name sshd -StartupType Automatic
Start-Service -Name sshd

# Verify listening
Get-NetTCPConnection -LocalPort 22
```

---

## üõ∞Ô∏è Linux systemd equivalents (short note)

If you‚Äôre on Linux (Ubuntu) the same concepts apply but use `systemctl`:

```bash
# Start now
sudo systemctl start ssh

# Enable at boot
sudo systemctl enable ssh

# Restart after config change
sudo systemctl restart ssh

# Status + logs
sudo systemctl status ssh
sudo journalctl -u ssh -e
```

(Windows Services GUI ‚âà Linux `systemd` unit file properties.)

---

## ‚úÖ Final tips & security reminders

* If this is a remote server, make sure a firewall rule allows SSH **before** you stop/start/enable the service, so you don‚Äôt lock yourself out.
* After starting, test from another machine: `ssh user@server-ip`.
* For production, prefer **Automatic** startup and **Recovery ‚Üí Restart** so SSH is resilient across reboots/crashes.
* Harden the server (public-key auth, disable root/password logins, monitor logs) once service is reliably running.

---