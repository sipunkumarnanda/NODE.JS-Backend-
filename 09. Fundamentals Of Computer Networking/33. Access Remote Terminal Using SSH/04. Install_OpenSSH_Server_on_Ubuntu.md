

# üõ†Ô∏è Install & Start SSH Server on Ubuntu ‚Äî Step-by-step (in-depth) üîê

Nice ‚Äî below is a clear, practical, and slightly geeky walkthrough of the exact commands you wrote (`sudo apt update`, `sudo apt upgrade`, `sudo apt install openssh-server`, checking/starting the service, and allowing SSH through UFW). Each step shows *what the command does*, *why it matters*, common flags, and *how to verify* things worked. Let‚Äôs go!

---

## üîÅ 1) Prepare the package system ‚Äî `sudo apt update`

```bash
sudo apt update
```

**What it does (in depth):**

* `apt update` fetches and refreshes the package **index** from all configured repositories (the lists of available packages and their latest versions).
* It **does not** install or upgrade any software. Instead it makes your system aware of what versions are available, which is required before you ask `apt` to install or upgrade packages.
* You should run this whenever you want to install new packages or upgrade existing ones, so `apt` works from fresh metadata. ([Ask Ubuntu][1])

**Notes / flags:**

* No interactive prompts; safe to run frequently.
* If you get network errors, check `/etc/apt/sources.list` or internet connectivity.

---

## ‚¨ÜÔ∏è 2) Upgrade installed packages ‚Äî `sudo apt upgrade`

```bash
sudo apt upgrade
# (add -y to auto-accept prompts)
sudo apt upgrade -y
```

**What it does (in depth):**

* `apt upgrade` **downloads and installs newer versions** of packages that are already installed, based on the updated package lists from `apt update`.
* It will upgrade packages **without** removing currently installed packages ‚Äî if an upgrade requires removing packages or changing dependencies in a disruptive way, `apt upgrade` will hold those back. (For more aggressive upgrades that may remove packages as needed, use `sudo apt full-upgrade` or `sudo apt dist-upgrade`.) ([blog.packagecloud.io][2])

**Why do this before installing SSH?**

* Keeps your system up-to-date, avoids dependency/version issues when installing new packages (like `openssh-server`), and reduces surprise bugs.

---

## üñ•Ô∏è 3) Install the OpenSSH server package ‚Äî `sudo apt install openssh-server`

```bash
sudo apt install openssh-server
# or non-interactive:
sudo apt install -y openssh-server
```

**What it does (in depth):**

* This tells `apt` to download the `openssh-server` package and any required dependencies from your configured repositories, and then installs and configures them using `dpkg`.
* The package provides the SSH server daemon (`sshd`) and supporting tools. On installation, configuration files live in `/etc/ssh/` (notably `/etc/ssh/sshd_config`). The package installation typically puts the `ssh.service` unit in place so `systemd` can manage the server. ([Ubuntu Documentation][3])

**Behind the scenes:**

* `apt` resolves dependencies, downloads `.deb` files, and `dpkg` runs pre/post install scripts shipped with the package (these can create default config files, register systemd units, etc.).
* If host keys are missing, the server or package scripts will generate SSH host keys (used to identify the server to connecting clients) the first time `sshd` starts.

---

## ‚ñ∂Ô∏è 4) Check the SSH service status ‚Äî `sudo systemctl status ssh`

```bash
sudo systemctl status ssh
```

**How to read the key parts of the output (in depth):**
Typical output snippet:

```
‚óè ssh.service - OpenBSD Secure Shell server
   Loaded: loaded (/lib/systemd/system/ssh.service; enabled; vendor preset: enabled)
   Active: active (running) since Fri 2025-10-03 10:12:34 UTC; 1h 23min ago
  Main PID: 1250 (sshd)
    Tasks: 1
   Memory: 3.8M
   CGroup: /system.slice/ssh.service
           ‚îî‚îÄ1250 /usr/sbin/sshd -D
```

* **Loaded:** unit file location and whether it‚Äôs enabled to start at boot.
* **Active:** `active (running)` means the service is up. If it shows `inactive`, `failed` or `activating`, that tells you the server is not ready.
* **Main PID:** the process id of the running `sshd`.
* **Log lines:** `systemctl status` shows recent journal lines for quick debugging.

**If you don‚Äôt see `active (running)`,** use the commands below to start/enable (next). ([DEV Community][4])

---

## ‚ñ∂Ô∏è 5) Start (and enable) the SSH server ‚Äî `sudo systemctl start ssh` (and enable on boot)

```bash
# Start now
sudo systemctl start ssh

# Enable at boot (so it starts automatically after reboot)
sudo systemctl enable ssh

# Or do both at once:
sudo systemctl enable --now ssh
```

**What these do (in depth):**

* `start` launches the running service now (creates the process).
* `enable` creates the necessary systemd symlinks so the service is started automatically during boot.
* `enable --now` is a convenient one-liner to both enable and start immediately. After running, re-check status with `sudo systemctl status ssh`. ([DEV Community][4])

**Troubleshooting:**

* If `start` fails, check `sudo journalctl -u ssh -b` for detailed logs.
* Common causes: port 22 already used, syntax error in `/etc/ssh/sshd_config`, or missing host keys/permissions issues.

---

## üî• 6) Allow incoming SSH through the firewall ‚Äî `sudo ufw allow ssh`

```bash
# Allow SSH (service name)
sudo ufw allow ssh

# or explicitly allow port 22/tcp
sudo ufw allow 22/tcp

# Check firewall status
sudo ufw status verbose
```

**What it does (in depth):**

* UFW (Uncomplicated Firewall) recognizes service profiles (like `ssh` or `OpenSSH`) so `ufw allow ssh` creates rules allowing incoming TCP connections to the SSH port (usually 22).
* If you use the service name, UFW maps that to the correct port/protocol via its profiles (`/etc/ufw/applications.d` or `/etc/services`). ([DigitalOcean][5])

**Important safety note:**
If you are connected to the machine over SSH *right now*, **add the SSH allow rule before enabling UFW** ‚Äî otherwise you will lock yourself out. Example:

```bash
sudo ufw allow OpenSSH
sudo ufw enable
```

DigitalOcean / Ubuntu guides stress: *always allow SSH before enabling the firewall* to avoid losing remote access. ([DigitalOcean][5])

---

## ‚úÖ 7) Verify the server is listening and test connections

**Check listening TCP sockets (port 22):**

```bash
sudo ss -tlnp | grep :22
# or
sudo lsof -iTCP -sTCP:LISTEN -P -n | grep ssh
```

Look for a line showing `0.0.0.0:22` or `:::22` and the `sshd` process ‚Äî that proves the daemon is listening.

**Test from local machine (loopback):**

```bash
ssh localhost
# or
ssh youruser@127.0.0.1
```

**Test from a remote client:**

```bash
ssh youruser@your-server-ip
```

If the connection works, you‚Äôll get either a prompt for a password or a public-key login (depending on auth setup). If you see `Connection refused` ‚Üí service is not running or firewall blocking; if `Permission denied (publickey)` ‚Üí key/auth issue. Use `ssh -vvv` on the client for verbose debugging and check server logs with `sudo journalctl -u ssh -e`. ([DEV Community][4])

---

## üêû 8) Quick troubleshooting checklist

* `Connection refused` ‚Üí `sudo systemctl status ssh`, `ss -tlnp | grep :22`, check `ufw` rules.
* `Permission denied (publickey)` ‚Üí verify `~/.ssh/authorized_keys`, permissions (`~/.ssh` 700, `authorized_keys` 600), and whether `PubkeyAuthentication yes` in `/etc/ssh/sshd_config`.
* `Host key verification failed` ‚Üí client-side `~/.ssh/known_hosts` has a different fingerprint; verify host keys before accepting.
* Logs: `sudo journalctl -u ssh -b` and `/var/log/auth.log` (depending on your syslog setup) are essential. ([DEV Community][4])

---

## üîê 9) Basic security tips after install

* Use **public-key authentication** (generate keys with `ssh-keygen`) and set `PasswordAuthentication no` in `/etc/ssh/sshd_config` when you have keys working.
* Disable `PermitRootLogin` or set it to `prohibit-password` / `no`.
* Consider Fail2Ban to block brute force attempts.
* Keep the system updated regularly (`sudo apt update && sudo apt upgrade`).
  Ubuntu/OpenSSH docs and community guides walk through these hardening steps in detail. ([Ubuntu Documentation][3])

---

## üßæ Quick one-line summary (copy/paste)

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install -y openssh-server
sudo systemctl enable --now ssh
sudo ufw allow OpenSSH
sudo ss -tlnp | grep :22    # verify listening
```

---