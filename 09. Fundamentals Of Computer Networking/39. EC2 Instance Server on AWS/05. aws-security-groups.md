

# 🔒 AWS Security Groups — Inbound & Outbound Rules Explained in Depth ☁️🛡️

Security Groups in AWS are like **virtual firewalls** for your EC2 instances. They control **which traffic can enter (inbound)** and **which traffic can leave (outbound)** your instance. Understanding and configuring them properly is essential for security and accessibility.

---

## 🖥️ 1. What is a Security Group?

* A **Security Group (SG)** acts as a **virtual firewall** for EC2 instances.
* **Attached to an instance**, it controls traffic at the **instance level**.
* By default, a new SG:

  * Allows **all outbound traffic**
  * Blocks **all inbound traffic**

> Think of it as a **set of rules** that decides who can talk to your server and who can’t.

---

## 🌐 2. Inbound Rules (Traffic Coming In)

**Inbound rules** define which **incoming connections** are allowed to reach your EC2 instance.

### Key components of an inbound rule:

| Component      | Meaning                                                           |
| -------------- | ----------------------------------------------------------------- |
| **Type**       | Protocol type (HTTP, SSH, Custom TCP, etc.)                       |
| **Protocol**   | Actual network protocol (TCP, UDP, ICMP)                          |
| **Port Range** | Which port(s) the rule applies to (e.g., 22 for SSH, 80 for HTTP) |
| **Source**     | Which IP addresses or security groups are allowed to connect      |

### Example — Allow SSH & HTTP:

| Type       | Protocol | Port Range | Source                       |
| ---------- | -------- | ---------- | ---------------------------- |
| SSH        | TCP      | 22         | My IP (e.g., 203.0.113.5/32) |
| HTTP       | TCP      | 80         | Anywhere (0.0.0.0/0)         |
| Custom TCP | TCP      | 3000       | Anywhere (0.0.0.0/0)         |

**Explanation:**

* **SSH (22)** → only your IP can access terminal remotely
* **HTTP (80)** → anyone on the internet can access a web server
* **Custom TCP (3000)** → Node.js server accessible publicly

> **CIDR notation `/32`** → allows only a single IP.
> **`0.0.0.0/0`** → allows all IPv4 addresses.

---

## 🚀 3. Outbound Rules (Traffic Going Out)

**Outbound rules** control **which connections can leave the EC2 instance**.

### Default behavior:

* All outbound traffic is **allowed**.

### Key components:

| Component       | Meaning                                        |
| --------------- | ---------------------------------------------- |
| **Type**        | Protocol type (e.g., HTTP, HTTPS, All traffic) |
| **Protocol**    | TCP/UDP/ICMP                                   |
| **Port Range**  | Destination port (e.g., 80 for HTTP requests)  |
| **Destination** | IP or SG the traffic can go to                 |

### Example — Restrict outbound to HTTP/HTTPS:

| Type  | Protocol | Port Range | Destination |
| ----- | -------- | ---------- | ----------- |
| HTTP  | TCP      | 80         | 0.0.0.0/0   |
| HTTPS | TCP      | 443        | 0.0.0.0/0   |

> Restricting outbound traffic can improve security, but for most beginners, default **allow all outbound** is fine.

---

## ⚙️ 4. How to Set Up a Security Group

### Step 1 — Create Security Group

1. Go to **AWS Management Console → EC2 → Security Groups**
2. Click **Create security group**
3. Enter:

   * **Name**: e.g., `NodeServerSG`
   * **Description**: e.g., `Allows SSH, HTTP, Node.js traffic`
   * **VPC**: select your VPC

### Step 2 — Configure Inbound Rules

* Click **Add rule** for each needed protocol:

  * SSH → TCP 22 → Source = your IP
  * HTTP → TCP 80 → Source = 0.0.0.0/0
  * Custom TCP → TCP 3000 → Source = 0.0.0.0/0

### Step 3 — Configure Outbound Rules

* Leave default **All traffic → 0.0.0.0/0** for simplicity
* Or restrict to necessary ports (e.g., HTTP/HTTPS)

### Step 4 — Attach SG to EC2 Instance

1. Go to **EC2 → Instances**
2. Select your instance → **Security → Modify Security Groups**
3. Attach the newly created SG

---

## 🔍 5. How Rules Work Together

* **Inbound** rules: decide **who can connect to your instance**
* **Outbound** rules: decide **where your instance can send traffic**
* Rules are **stateful** → if inbound is allowed, reply traffic automatically flows back even if outbound doesn’t explicitly allow it

> Example: SSH inbound from your IP works because outbound replies are automatically allowed.

---

## ⚡ 6. Security Best Practices

1. **SSH access**: Restrict to your IP (`/32`)
2. **HTTP/Custom servers**: Use `0.0.0.0/0` only if needed
3. **Remove unused rules** — only open required ports
4. **Use multiple SGs** for different types of servers (web, database)
5. **Audit SGs regularly** to avoid accidental exposure

---

## 📋 7. Quick Recap

| Rule Type | Purpose                                  | Example                 |
| --------- | ---------------------------------------- | ----------------------- |
| Inbound   | Control traffic coming **to EC2**        | TCP 22 SSH → My IP only |
| Inbound   | Control traffic coming **to web server** | TCP 80 HTTP → Anywhere  |
| Inbound   | Custom ports (Node.js)                   | TCP 3000 → Anywhere     |
| Outbound  | Control traffic leaving EC2              | Default: allow all      |
| Outbound  | Restrict if needed                       | TCP 80/443 → Anywhere   |

---

💡 **Summary:**
Security groups are **AWS firewalls**.

* Configure **inbound rules** for services your instance provides (SSH, HTTP, Node.js).
* Configure **outbound rules** for services your instance accesses.
* Always follow **least privilege principle** — open only required ports to minimize risk.

---