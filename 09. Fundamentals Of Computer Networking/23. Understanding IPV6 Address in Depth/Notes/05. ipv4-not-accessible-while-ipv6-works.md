

# üö¶ Why IPv6 reaches your server but IPv4 doesn't ‚Äî in-depth explanation with checks & fixes üõ†Ô∏è

Nice ‚Äî you‚Äôve got a server that **is reachable over IPv6 from the internet**, but **not reachable over IPv4**. That narrows things down a lot. Below I‚Äôll explain the likely root causes, how to **diagnose** each one (commands you can run), and **how to fix** them ‚Äî all with emojis for clarity. üéØ

---

## üîç Quick TL;DR

* **Most likely:** your network has a working public IPv6 path (GUA) but **no public IPv4 path** to your host (common causes: CGNAT, missing port-forward, ISP/consumer IPv4 blocking, or firewall).
* **Also possible:** server only listening on IPv6, or DNS A record wrong.
* **Fix paths:** enable/assign a public IPv4, add IPv4 port forwarding / firewall rules, or use IPv6-only solution (reverse proxy, tunnel, Cloudflare/ngrok). üåê

---

## 1Ô∏è‚É£ Carrier-Grade NAT (CGNAT) / No public IPv4 ‚Äî **most common** reason üö´üåç

**What it is:** your ISP gives you an IPv4 *but it‚Äôs not unique on the public Internet* ‚Äî they NAT many customers behind a shared IPv4 (CGNAT, RFC100.64.0.0/10). With CGNAT you cannot receive unsolicited inbound IPv4 connections.

**How to check**

* On the server/router, note the WAN IPv4 address (router status page or `ipconfig`/`ip addr`).
* From your server, query what IP the internet sees:

  * `curl -4 https://ifconfig.co`  (or use a browser at whatismyip).
* If the WAN IPv4 shown in your router ‚â† the public IPv4 seen on the web, you‚Äôre behind CGNAT or another upstream NAT.
* If the WAN IPv4 is in `100.64.0.0/10`, that‚Äôs evidence of CGNAT.

**Why IPv6 works:** your ISP provided you a global IPv6 prefix (GUA) and routes it to you directly ‚Äî so inbound IPv6 connections reach you without NAT.

**Fix**

* Ask ISP for a public IPv4 / static IPv4 or a port forwarding service.
* Use IPv6 natively (advertise AAAA/DNS).
* Use a tunneling / relay service (reverse SSH tunnel, ngrok, Cloudflare Tunnel) to expose service over IPv4.

---

## 2Ô∏è‚É£ Router NAT / Missing IPv4 port-forwarding üîÅ

**What it is:** your router has a public IPv4 but does not forward the desired port (e.g., 80/443/8080) to the internal host (10.x.x.x). IPv6 doesn‚Äôt need NAT, so it works.

**How to check**

* In router admin UI: check WAN IPv4, and check NAT/Port Forwarding rules.
* From an external machine: `telnet PUBLIC_IPV4 PORT` or `nc -vz PUBLIC_IPV4 PORT`. If it times out, port forwarding likely missing or blocked.
* Test IPv6 similarly: `nc -vz 2401:... PORT` (should succeed).

**Fix**

* Add a port forwarding rule: External port ‚Üí internal IPv4 address and same port.
* Ensure router firewall allows inbound IPv4 on that port.

---

## 3Ô∏è‚É£ Host/server firewall blocks IPv4 but not IPv6 üî•üßØ

**What it is:** firewall rules on your server (iptables, UFW, Windows Firewall) allow IPv6 traffic but block IPv4.

**How to check**

* Linux:

  * `sudo iptables -L -n`  (IPv4 rules)
  * `sudo ip6tables -L -n` (IPv6 rules)
  * `sudo ufw status verbose` (if using UFW ‚Äî it shows v6 rules too)
* Windows (PowerShell):

  * `Get-NetFirewallRule | Where-Object { $_.Enabled -eq "True" }`
  * Or check Windows Defender Firewall ‚Üí Inbound Rules (see whether rule applies to IPv4/IPv6)
* If IPv4 chain drops the port, that‚Äôs the issue.

**Fix**

* Add rules to allow the service port on IPv4:

  * `sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT` (example for port 80)
  * `sudo ufw allow 80/tcp`
  * Windows: `netsh advfirewall firewall add rule name="Allow HTTP IPv4" dir=in action=allow protocol=TCP localport=80`

---

## 4Ô∏è‚É£ Server is only listening on IPv6 (or listening IPv6-only) üß©

**What it is:** your server application is bound only to an IPv6 address (e.g. `::` or a specific IPv6), and the system is configured so that IPv6 sockets do **not** accept IPv4-mapped addresses ‚Äî therefore IPv6 clients succeed but IPv4 clients fail.

**How to check**

* Linux:

  * `ss -ltnp` or `netstat -tulpen` and look for `LISTEN` entries showing `:::` or `0.0.0.0`. Example: `[::]:8080` vs `0.0.0.0:8080`.
* Windows:

  * `netstat -ano | findstr LISTENING` then map PID to process.

**Interpretation**

* If you see only `[::]:PORT` and **no** `0.0.0.0:PORT`, the server might be IPv6-only (or configured so). Some systems allow a single IPv6 socket to accept IPv4 mapped addresses (dual-stack), others do not (controlled by `IPV6_V6ONLY`).

**Fix**

* Configure your app to listen on both IPv4 and IPv6 (bind `0.0.0.0` **and** `::`), or set the socket option to allow dual-stack:

  * Example (nginx): in `server {}` block use `listen 80;` and `listen [::]:80;` and/or `ipv6only=off;`.
  * In code (Python): set `socket.setsockopt(IPPROTO_IPV6, IPV6_V6ONLY, 0)` when binding `::`.

---

## 5Ô∏è‚É£ DNS mismatch: AAAA exists but A is missing/wrong üß≠

**What it is:** your domain has an AAAA record pointing to your IPv6 GUA, so `domain` ‚Üí IPv6 works, but the A record is absent or points to an old/wrong IPv4 address.

**How to check**

* From any machine:

  * `dig AAAA yourdomain.com` and `dig A yourdomain.com`
  * `nslookup -type=AAAA yourdomain.com` / `nslookup -type=A yourdomain.com`
* If `A` is missing or points to different IP, IPv4 clients resolving the domain will fail.

**Fix**

* Update DNS: add or correct the A record to the correct public IPv4 (and AAAA to the IPv6). Allow TTL/propagation.

---

## 6Ô∏è‚É£ ISP or upstream firewall blocks inbound IPv4 traffic üîí

**What it is:** your ISP or upstream router blocks inbound IPv4 (common on consumer plans to prevent servers). They may still route IPv6.

**How to check**

* Try connecting from an external network to your public IPv4 port. Also test with a different ISP or mobile network.
* Contact ISP support to ask whether inbound IPv4 ports are blocked for your connection type.

**Fix**

* Request unblocking or business/static IP. Or use an IPv6-native approach or reverse tunnel.

---

## 7Ô∏è‚É£ NAT hairpin / loopback issues (accessing your public IPv4 from inside network) ‚Ü∫

**What it is:** when you try to use the router‚Äôs public IPv4 from inside the LAN, some routers don‚Äôt support NAT loopback (hairpin NAT). IPv6 global may route correctly inside.

**How to check**

* From inside LAN: try public IPv4 ‚Äî may fail. From *outside* (mobile data or remote host) test public IPv4.
* If remote works but inside doesn‚Äôt, it‚Äôs hairpin NAT: router limitation.

**Fix**

* Use the server‚Äôs LAN IPv4 when on the LAN, or enable hairpin NAT on router (if available), or use split-horizon DNS (internal A points to local IP, external to public IP).

---

## ‚úÖ Practical diagnostic checklist (run these)

1. **Check server listening:**

   * Linux: `ss -ltnp` or `sudo netstat -tulpen`
   * Windows: `netstat -ano | findstr LISTENING`
2. **Check addresses on host:**

   * Linux: `ip -4 addr show` and `ip -6 addr show`
   * Windows: `ipconfig /all`
3. **Check router WAN vs public IP:**

   * Router admin page; `curl -4 https://ifconfig.co` from host.
4. **Test remote connectivity:**

   * From outside network: `telnet PUBLIC_IPV4 PORT` and `telnet PUBLIC_IPV6 PORT` (or `nc -vz ...`)
   * For HTTP: `curl -v http://PUBLIC_IPV4:PORT/` and `curl -6 -v 'http://[PUBLIC_IPV6]:PORT/'` (use `[]` around IPv6)
5. **Check firewall rules:**

   * Linux: `sudo iptables -L -n` and `sudo ip6tables -L -n`
   * Windows: inspect inbound firewall rules
6. **Check DNS:**

   * `dig A yourdomain.com` and `dig AAAA yourdomain.com`
7. **Traceroute to see where IPv4 stops:**

   * `traceroute -4 PUBLIC_IPV4` / Windows `tracert PUBLIC_IPV4`
   * `traceroute -6 PUBLIC_IPV6`

---

## üõ†Ô∏è Typical fixes (pick what fits your diagnosis)

* **If CGNAT:** ask ISP for public IPv4 / port mapping, or use tunnel/proxy (Cloudflare Tunnel, ngrok, VPS reverse proxy).
* **If missing NAT/port-forward:** add port forwarding to internal IPv4 host.
* **If firewall:** open the port for IPv4 on host and router.
* **If server bound IPv6-only:** bind also to IPv4 or enable dual-stack.
* **If DNS wrong:** update A record to correct public IPv4.
* **If ISP blocks port 80/443:** use alternate ports or get ISP support/business plan.

---

## üßæ Short example commands & config snippets

**Check listening (Linux):**

```bash
ss -ltnp        # look for lines like 0.0.0.0:80 or [::]:80
```

**Allow IPv4 TCP port 8080 with iptables:**

```bash
sudo iptables -A INPUT -p tcp --dport 8080 -j ACCEPT
```

**nginx listens on both IPv4 & IPv6:**

```nginx
server {
    listen 80;
    listen [::]:80;
    ...
}
```

**Curl IPv6 request to a raw address:**

```bash
curl -6 "http://[2401:4900:...]:8080/"
```

**Check public IP:**

```bash
curl -4 https://ifconfig.co    # shows public IPv4
curl -6 https://ifconfig.co    # shows public IPv6
```

---

## ‚úÖ Final summary

* **IPv6 works because you have a public/global IPv6 path to your machine.**
* **IPv4 fails because something on the IPv4 path prevents inbound connections** ‚Äî common culprits: CGNAT, missing IPv4 port-forwarding, IPv4 firewall rules, server bound only to IPv6, or wrong DNS A record.
* Run the diagnostic checklist above; you‚Äôll quickly see whether the problem is **server**, **router/firewall**, **ISP/CAGNAT**, or **DNS**. Once you identify which one, use the matching fix (open firewall, add NAT rule, request public IPv4, or bind to IPv4).

---