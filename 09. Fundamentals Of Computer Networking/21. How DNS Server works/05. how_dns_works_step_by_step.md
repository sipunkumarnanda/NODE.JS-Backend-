

# 🌐 How DNS Resolution Works: Step by Step

DNS (Domain Name System) is like the **phonebook of the internet**. It translates **human-readable domain names** like `example.com` into **IP addresses** like `93.184.216.34`.

When you type a domain into your browser, DNS resolution goes through **multiple layers** before returning the IP address. Let’s go step by step.

---

## 1️⃣ Browser Cache 🧠💾

* Modern browsers store recently visited domain resolutions in **cache** to speed up access.
* **Example:** You type `example.com`. If your browser has it cached, it directly returns the IP without querying DNS servers.

**Benefits:**

* Fast access 🚀
* Reduces network traffic 🌍

---

## 2️⃣ Operating System (OS) Cache 💻🗂️

* If the browser cache doesn’t have the record, the OS checks its **DNS resolver cache**.
* The OS cache stores **recently resolved domains system-wide**, not just for a single browser.

**Check OS cache:**

* Windows: `ipconfig /displaydns`
* macOS: `sudo killall -INFO mDNSResponder`
* Linux: Depends on DNS service (e.g., `systemd-resolved`, `nscd`)

**Example:**

* Browser misses `example.com` → OS cache has `93.184.216.34` → used immediately.

---

## 3️⃣ ISP DNS Server Cache 🖧🏢

* If OS cache doesn’t have the record, the query is sent to your **ISP’s DNS server**.
* The ISP DNS server keeps a **cache of recently resolved domains**.

**Example:**

* Your ISP DNS server has recently resolved `example.com` → it responds immediately with `93.184.216.34`.

**Benefits:**

* Speeds up resolution 🌟
* Reduces repeated traffic to higher-level DNS servers

---

## 4️⃣ Recursive Query to Root DNS Servers 🌳🛰️

* If the ISP DNS server doesn’t have the domain cached, it performs a **recursive query** starting with the **root DNS servers**.
* There are **13 logical root server addresses** named `A` to `M`:

| Root Server | Logical Name       | Example Physical Locations  |
| ----------- | ------------------ | --------------------------- |
| A           | a.root-servers.net | USA, Europe, Asia (anycast) |
| B           | b.root-servers.net | USA, Europe, Asia           |
| C           | c.root-servers.net | USA, Europe, Asia           |
| D           | d.root-servers.net | USA, Europe, Asia           |
| E           | e.root-servers.net | USA, Europe, Asia           |
| F           | f.root-servers.net | USA, Europe, Asia           |
| G           | g.root-servers.net | USA, Europe, Asia           |
| H           | h.root-servers.net | USA, Europe, Asia           |
| I           | i.root-servers.net | USA, Europe, Asia           |
| J           | j.root-servers.net | USA, Europe, Asia           |
| K           | k.root-servers.net | USA, Europe, Asia           |
| L           | l.root-servers.net | USA, Europe, Asia           |
| M           | m.root-servers.net | USA, Europe, Asia           |

**Important:**

* There are **13 logical root servers**, but each has **many physical servers worldwide** using **anycast** for speed and redundancy.

**Role:**

* Root servers **don’t know the IP of the final domain**.
* They direct queries to the **TLD (Top-Level Domain) servers**.

---

## 5️⃣ TLD DNS Servers 🏷️🌍

* **TLD (Top-Level Domain) servers** are responsible for **.com, .org, .net, .in**, etc.
* After querying the root server, the ISP DNS is referred to the **TLD server**.

**Example:**

* For `example.com`, the root server points to **.com TLD servers**.

**Role:**

* TLD servers **know which authoritative server handles the specific domain**.

---

## 6️⃣ Authoritative DNS Server 🏢🔑

* The **authoritative DNS server** for `example.com` holds the **actual IP address**.
* Once the recursive DNS query reaches here, it **returns the final answer**.

**Example:**

* Authoritative server says: `example.com → 93.184.216.34`

---

## 7️⃣ Glue Records 🧩📝

* Sometimes, the **name server for a domain is within the domain itself**.
* Glue records are **IP addresses provided by parent DNS zones** to prevent **circular dependency**.

**Example:**

* Domain: `example.com`
* Name server: `ns1.example.com`
* Glue record provides IP: `192.0.2.53`
* Without glue records, the resolver wouldn’t know where to start querying `ns1.example.com`.

---

## 8️⃣ DNS Resolution Flow Summary 🌟

Here’s the **full step-by-step flow**:

1. Browser cache 🧠 → Found? ✅ Use IP
2. OS cache 💻 → Found? ✅ Use IP
3. ISP DNS cache 🏢 → Found? ✅ Use IP
4. Root DNS server 🌳 → Provides TLD server
5. TLD server 🏷️ → Provides authoritative server
6. Authoritative server 🏢 → Returns final IP
7. Browser connects 💻➡️🌐

**Example with `example.com`**:

```
Browser → OS Cache → ISP DNS → Root (.) → .com TLD → Authoritative (example.com) → IP: 93.184.216.34
```

---

## 9️⃣ Visual Representation 🌈

* Browser 🧠 → OS Cache 💻 → ISP DNS 🏢 → Root 🌳 → TLD 🏷️ → Authoritative 🏢 → IP 🌐 → Browser 💻
* Every stage can **cache results** to speed up future queries ⏱️

---

## 10️⃣ Key Takeaways 💡

* DNS resolution is **hierarchical and recursive**.
* **Caches** at each level improve speed and reduce network traffic.
* **13 root servers** are logical, with **anycasted physical servers worldwide**.
* **Glue records** prevent circular dependencies.
* Manual queries can trace this flow using commands like:

```bash
nslookup example.com
dig example.com +trace
```

---